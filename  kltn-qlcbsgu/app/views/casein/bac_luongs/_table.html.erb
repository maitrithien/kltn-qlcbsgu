<!-- Scaffolding generated by Casein v.3.1.11 -->
<div style="margin-bottom: 10px; padding:0">
<%= link_to "#{casein_show_icon('grid_view')}".html_safe, casein_bac_luongs_path(:view => "grid"), {:title => "Xem dạng lưới", :class => "grid_link"} %>
<%= link_to "#{casein_show_icon('table')}".html_safe, casein_bac_luongs_path(:view => nil), {:title => "Xem dạng danh sách", :class => "list_link"} %>
</div>


<% if params[:view].blank? %>
<table cellpadding="0" cellspacing="0" id="itemList" class="itemList">
	<tr>
		<th>Ngạch</th>
		<th>Bậc Lương</th>
		<th>Hệ Số Lương</th>
		<th>Ghi Chú</th>
		<th>&nbsp;</th>
	</tr>
	
	<% bac_luongs.each_with_index do |bac_luong, index| %>
		<tr class="<%= 'even' if index.modulo(2) == 0 %> hover">
			<td><%= casein_table_cell_link "#{bac_luong.ngach.ma_ngach} - #{bac_luong.ngach.ten_ngach}", casein_bac_luong_path(bac_luong) %></td>
			<td><%= casein_table_cell_link "Bậc #{bac_luong.bac}", casein_bac_luong_path(bac_luong) %></td>
			<td>
              <% if bac_luong.vuot_khung %>
                  <%= casein_table_cell_link "Vượt khung #{bac_luong.he_so_luong}%", casein_bac_luong_path(bac_luong) %>
              <% else %>
                  <%= casein_table_cell_link bac_luong.he_so_luong, casein_bac_luong_path(bac_luong) %>
              <% end %>
            </td>
			<td><%= casein_table_cell_link bac_luong.ghi_chu, casein_bac_luong_path(bac_luong) %></td>
			<td class="delete">
				<%= link_to(casein_show_row_icon("delete"), casein_bac_luong_path(bac_luong), :method => :delete, :confirm => "Bạn có chắc muốn xóa ngạch #{bac_luong.ngach.ma_ngach} bậc #{bac_luong.bac}?") %>
			</td>
		</tr>
	<% end %>
</table>

<% else %>
<div class="overflow">
<table cellpadding="0" cellspacing="0" id="itemList" class="itemList">
	<tbody>
	<tr>
		<th>Ngạch</th>
		<% 1.upto(@max) do |i| %>
			<th class="align-center"><%= i %></th>
		<% end %>
	</tr>
	</tbody>

<% @bac_luongs_group.map do |hash| %>
	<tr>

		<th title="<%= hash[0][:ten_ngach].to_s %>">
			<%= hash[0][:ngach_id].to_s %>
		</th>
			<% index = 0 %>
			<% hash[0][:bac_luongs].map do |p| %>
				<% index += 1 %>
				<% if index == p[:bac].to_i %>
					<td class="normal <%= 'over' if p[:vuot_khung] %>">
						<% if p[:vuot_khung] %>
							<%= link_to p[:he_so_luong].to_i, casein_bac_luong_path(BacLuong.find(p[:id])), :title => "Ngạch #{hash[0][:ngach_id].to_s} - Bậc #{p[:bac]}: Vượt khung #{p[:he_so_luong].to_i} %" %>
						<% else %>
							<%= link_to p[:he_so_luong].to_s, casein_bac_luong_path(BacLuong.find(p[:id])), :title => "Ngạch #{hash[0][:ngach_id].to_s} - Bậc #{p[:bac]}: #{p[:he_so_luong].to_s}" %>
						<% end %>
					</td>
				<% else %>
					<% index.upto(p[:bac].to_i) do |i| %>
						<% if i == p[:bac].to_i %>
								<td class="normal <%= 'over' if p[:vuot_khung] %>">
									<% if p[:vuot_khung] %>
										<%= link_to p[:he_so_luong].to_i, casein_bac_luong_path(BacLuong.find(p[:id])), :title => "Ngạch #{hash[0][:ngach_id].to_s} - Bậc #{p[:bac]}: Vượt khung #{p[:he_so_luong].to_i} %" %>
									<% else %>
										<%= link_to p[:he_so_luong].to_s, casein_bac_luong_path(BacLuong.find(p[:id])), :title => "Ngạch #{hash[0][:ngach_id].to_s} - Bậc #{p[:bac]}: #{p[:he_so_luong].to_s}" %>
									<% end %>						
								</td>						
						<% else %>
							<td class="normal">-</td>
						<% end %>
						<% index = i %>
					<% end %>		
				<% end %>
			<% end %>
	</tr>
	<tr></tr>
<% end %>
</table>
</div>

<% end %>